
(subrecord notable
           (note string option))

;;Static files, â€¦
(subrecord is_file 
           (file_name string)
           (file_id int)
           (hr_tag string option))
(subrecord is_directory
           (dir_id int)
           (hr_tag string option))


;; Almost static input data:
(record person
       (print_name      string option)
       (family_name     string)
       (email           string)
       notable
       )

(record organism
        (name string option)
        (informal string option)
        notable)

(record sample
        (name        string)
        (organism    organism)
        notable)


(subrecord barcode
           (vendor_id int)
           (barcode string))
(record bioo_barcode barcode)
(record truseq_barcode barcode)


(record protocol
       (name string)
       is_directory
       notable)

;; Functions:

(enumeration read_type read_PE_50x50 read_PE_100x100 read_SE_50 read_SE_100)

(record library
          (name           string)
          (sample      sample)
          (protocol  protocol)
          (vial_id        int)
          (application    string)
          (stranded       bool)
          (control_type   string)
          (truseq_control bool)
          (rnaseq_control string)
          (read_type      read_type)
        (bioo_barcodes bioo_barcode array)
        (truseq_barcodes truseq_barcode array)
        notable
)

(record key_value
        (key string)
        (value string))

(record input_library
        (library library)
        (submission_date timestamp)
        (contacts     person array)
        (volume_uL real)
        (concentration_nM real)
        (user_db key_value array)
        notable
)

(record lane
        (libraries input_library array))

(record flowcell
        (vendor_name string)
        (lanes lane array))

(record qpcr
        (library library)
        (concentration real)
        (volume real))

(record bioanalyzer
        (library library)
        (well_number int)
        is_directory
        (pdf_name string option)
        (xad_name string option)
        (mean_fragment_size real))
(record agarose_gel
        (library library)
        (well_number int)
        is_directory
        (pdf_name string option)
        (mean_fragment_size real))

(record hiseq_raw
        (flowcell_name string)
        (with_intensities bool)
        (host string)
        (hiseq_dir_name string))

(record sample_sheet is_file notable)
        
(enumeration sample_sheet_kind all_barcodes specific_barcodes)

(function sample_sheet assemble_sample_sheet
          (kind sample_sheet_kind) ;; All barcodes or not
          (flowcell flowcell)
          )

(record bcl_to_fastq_unaligned is_directory)

(function bcl_to_fastq_unaligned bcl_to_fastq
          (raw_data hiseq_raw)
          (mismatch int)
          (version string)
          (sample_sheet sample_sheet))

(function hiseq_raw transfer_hisqeq_raw
          (hiseq_raw hiseq_raw)
          (dest string))

(function hiseq_raw delete_intensities
          (hiseq_raw hiseq_raw))

(record hiseq_checksum
        (file string))
(function hiseq_checksum dircmp_raw
        (hiseq_raw hiseq_raw))


(record client_fastqs_dir
        (dir__dirfile string))

(function client_fastqs_dir prepare_delivery
          (unaligned bcl_to_fastq_unaligned)
          (info flowcell))

;;  
;; (function file library_fastx_stats
;;           (library_fastqs file)
;;           (other_param int)
;;           (stats file)
;;           )
;;  
;; (value deliverable
;;        (fastq_dir file)
;;        (stats_dir file)
;;        (email_body string))
